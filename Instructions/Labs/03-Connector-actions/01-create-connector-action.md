---
lab:
  title: '3.1: コネクタ アクションを作成する'
---

# コネクタ アクションの作成

この演習では、Copilot Studio で宣言型エージェントのコネクタ アクションを構成します。 "SharePoint - リスト フォルダー" コネクタを使用して、製品サポート ファイルを含んだ Products フォルダーからファイルのリストを取得します。

この演習の所要時間は約 **15** 分です。

## 開始する前に

この演習では、既存エージェントへのコネクタ アクションの追加に重点を置いています。 この演習では、次のことを前提としています。

1. Copilot Studio で既に **Product support** 宣言型エージェントを作成しました。 宣言型エージェントを作成する手順については、「[宣言型エージェントを作成する](../01-Build-your-first-declarative-agent/01-create-declarative-agent.md)」をご覧ください。
1. **Product Support** というタイトルの SharePoint サイトがあり、その中に、サンプル製品関連データのファイルを含んだ **Products** という名前のドキュメント ライブラリが格納されています。 手順については、演習「[カスタム ナレッジを追加する](../01-Build-your-first-declarative-agent/02-add-custom-knowledge.md)」内の**開始前**というタイトルのセクションをご覧ください。

## SharePoint コネクタ アクションを作成する

1. Web ブラウザーで、[Copilot Studio](https://www.copilotstudio.microsoft.com) (`https://www.copilotstudio.microsoft.com`) に移動します。
1. **[ライブラリ]** から **Product Support** エージェントを選びます。
1. **[アクション]** で、**[アクションの追加]** を選択します。
1. **[アクションの追加]** ウィンドウで、**検索**バーに「`SharePoint`」と入力します。 適切なアクションがウィンドウに表示されるまで待ちます。
1. **リスト フォルダー SharePoint** コネクタ アクションを参照して選択します。
1. モーダル ウィンドウに、SharePoint コネクタの接続が表示されます。 接続がアクティブな場合は、コネクタの横に緑色のチェックマークが表示されます。 **[...]** を選択して、接続の詳細を表示することができます。
    ![SharePoint 接続の状態を示すスクリーンショット](../Media/SharePoint-connection.png)
1. 接続がアクティブな場合は、**[次へ]** を選択します。 **[リスト フォルダー]** ページに移動するので、そこでアクションのプロパティを構成します。
1. **[名前]** テキスト ボックスに「`List product support files`」と入力します。
1. **[Description]** テキスト ボックスに「`List product support files available in the Products folder`」と入力します。
1. **[エンド ユーザー認証]** が **[ユーザー認証]** に設定されていることを確認します。
1. **[入力と出力]** セクションを展開します。
1. **[サイト アドレス]** 入力を選択します。
1. **[値]** テキスト ボックスに、**Product Support** SharePoint サイトの URL を `https://DOMAIN.sharepoint.com/sites/ProductSupport` 形式で入力したあと、**[完了]** を選択します。
1. **[ファイル識別子]** 入力を選択します。
1. **[エージェントは、この入力をどのように入力しますか]** をドロップダウンから **[値として設定する]** に設定したあと、**[確認]** を選択します。
1. **[値]** テキスト ボックスに「`Products`」と入力したあと、**[完了]** を選択します。
1. **[アクションの追加]** ボタンを選択し、SharePoint アクションがエージェントに追加されるまで待ちます。 これで、このアクションがエージェントの詳細ページの **[アクション]** セクションに一覧表示されます。

## アクションを構成する

1. **[アクション]** セクションで、**リスト製品サポート ファイル** アクションを選択して詳細ページを開きます。
1. **[出力]** タブに移動します。
1. テストのために、**[このアクションの結果を表示する方法の選択]** で **[アクションの実行直後にメッセージを送信]** チェックボックスをオンにします。 追加の構成オプションが表示されます。
1. **[ユーザーに情報を表示する方法]** でドロップダウンを選択し、**[メッセージを作成する]** を選択します。 テキスト ボックスが表示されます。
1. **[表示するメッセージ]** テキスト ボックスに「`You used the SharePoint connector`」と入力し、ページの上部にある **[保存]** を選択します。

## エージェントの指示を変更する

エージェントの指示も更新して、コネクタ アクションを使用するためのガイダンスを提供しましょう。

1. **Product Support** エージェントの **[詳細]** セクションで、**[編集]** を選択します。
1. **[指示]** テキスト ボックスで、既存の指示テキストに「`When asked about available support resources, use the SharePoint connector to list the files in the Products folder.`」を追加します。
1. **[保存]** を選択します。

## アクションを使用してエージェントをテストする

1. エージェントの詳細ページの右側にある **[エージェントのテスト]** ウィンドウを展開します。
1. テスト ウィンドウで **[更新]** ボタンを選択して、エージェントの最新の変更点を読み込みます。
1. メッセージ ボックスに「`What product support files are available?`」と入力し、メッセージを送信します。
1. エージェントが "SharePoint コネクタを使用しました" というメッセージを返してから、Products フォルダーで使用可能なファイルを一覧表示することに注目してください。

コネクタ アクションがエージェント内で正常に動作することを検証しました。
